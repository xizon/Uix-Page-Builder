!function(a){a.fn.UixPBFormPop=function(b){var c=a.extend({postID:"",title:"",trigger:"",errorInfo:"Timeout expired. The timeout period elapsed prior to completion of the operation or the server is not responding. ",initFunction:function(){},startFunction:function(){}},b);this.each(function(){function l(b){a(".uixpbform-modal-box").each(function(){var c=b,d=c.find('[name="section"]').val(),e=c.find('[name="row"]').val(),f=c.find('[name="colid"]').val(),g=f.replace("---","----"),h=uixpbform_to_col_numberID(f),i=[],j=[];if(void 0!==f){var k=a("[name^='"+d+"-"+g+"']"),l=k.serializeArray();i.push(["col",h]),j.push(["section",d]),j.push(["row",e]),j.push(["widgetname","Section "+e]);for(var m=0;m<l.length;m++){var n=l[m].name,o=l[m].value,p=uixpbform_to_controlID_ToSave(n,d,e,f);if(n.indexOf("__index__")<0){if(n.indexOf("_temp")<0){var q=a("#"+n).data("callback");o=void 0!==q?uixpbform_value_callback(o,q):uixpbform_format_text_entering(o)}o=uixpbform_textarea_to_JSONSaveData(o),void 0!==a("#"+n).attr("data-enter-value")&&""==o&&(o="&nbsp;"),i.push([p,o])}}var r=JSON.stringify(i);uixpbform_insertCodes(d,r,f,e);(new UixPBGridsterMain).itemSave(e),j.push(["rowcontent","{allcontent}"]);var t=JSON.stringify(j);uixpbform_insertCodes(d,t,"cols-all-content-replace-"+e,e)}})}var d=(a(this),c.trigger.replace(".","").replace("#","")),e=c.title,g=(c.postID,c.trigger),i=(c.errorInfo,"uixpbform-modal-open-"+d),j=g.replace(".","").replace("#",""),k={formID:j,title:e,thisModalID:i,thisFormName:d};a(".uixpbform-modal-mask").length<1&&a("body").prepend('<div class="uixpbform-modal-mask"></div>'),a("#"+k.thisModalID).length<1&&a("body").prepend('<div class="uixpbform-modal-box" id="'+k.thisModalID+'"><a href="javascript:void(0)" class="close-btn close-uixpbform-modal">&times;</a><div class="content"><h2>'+k.title+'</h2><span class="iconslist-box"></span><span class="echo-module-temp"></span><span class="echo-module-temp-clone" style="display:none"></span><span class="echo-frontend-temp" style="display:none"></span></div></div>'),"[object Function]"==Object.prototype.toString.call(c.initFunction)&&c.initFunction(k),a(document).on("click",g,function(b){b.preventDefault();var d=a(this).data("id"),g=a(this).data("name"),h=a(this).data("col-textareaid"),k={formID:j,ID:d,contentID:"content-data-"+d,title:e,name:g,thisModalID:i,sectionID:d,colID:h},m=a(".uixpbform-modal-box#"+i),n=.8*a(window).height()-150,o=".uixpbform-modal-box#"+i+" .echo-module-temp",p=".uixpbform-modal-box#"+i+" .echo-frontend-temp";if(a(this).parent(".uix-page-builder-col").length>0&&!0,m.length>0){var r=j,s=d,t=h,u=t.replace("---","----"),v=t.replace("col-item-","").replace("---"+s,""),y=uixpbform_module_form_ids(r,s,t,!1);m.UixPBFormPopWinReset({heightChange:220}),m.attr({"data-tempID":r,"data-colID":t,"data-colIDToVar":u,"data-sectionID":s,"data-echoFrontendID":p,"data-colNumber":v}),a(o).html(""),uixpbform_isJSON(y)&&a("#module_tmpl__"+r).tmpl(JSON.parse(y)).appendTo(o),m.find('form [name="section"]').val(r),m.find('form [name="colid"]').val(t),m.find('form [name="row"]').val(s),a(document).uixpbform_init_controls({form:m}),uixpbform_clonedata_exists(y)&&m.find(".uixpbform_btn_trigger-clone").uixpbform_dynamicFormInit({type:"load"}),0==m.find(".iconslist-box").html().length&&m.find(".iconslist-box").html(a(".uixpbform-icon-selector-btn-target").html());var z=0,A=0,B=a(o).find(".uixpbform-form-container"),C=a(o).find(".uixpbform-table-cols-wrapper"),D=Array();if(C.length>0){C.each(function(b){var c=a(this).height();a(this).hasClass("uixpbform-table-col-1")&&(A=c),D.push(parseFloat(c)+parseFloat(A))});for(var F=-1/0,G=0;G<D.length;G++)D[G]>F&&(z=D[G])}else z=B.height();(null==z||0==z||parseFloat(z+150+.2*a(window).height())>a(window).height())&&(z=n),m.css("height",parseFloat(z+150)+"px"),m.find(".uixpbform-modal-buttons").css("margin-top",parseFloat(z/2+20)+"px"),a(".uixpbform_btn_trigger-clone").on("click",function(b){b.preventDefault();var c=.8*a(window).height()-150+150;m.css("height",c+"px"),m.find(".uixpbform-modal-buttons").css("margin-top",.8*c/2+"px")}),a(".uixpbform-modal-box .close-uixpbform-modal").on("click",function(b){b.preventDefault(),a(document).UixPBFormPopClose(),a(".uixpbform-modal-box .iconslist-box").removeAttr("id").removeClass("active")})}"[object Function]"==Object.prototype.toString.call(c.startFunction)&&c.startFunction(k),a(".uixpbform-modal-box .close-uixpbform-modal").on("click",function(b){b.preventDefault(),a(this).parent().removeClass("active"),a(document).UixPBFormPopClose(),a(".uixpbform-modal-box .iconslist-box").removeAttr("id").removeClass("active")})}),a(document).on("click",".uixpbform-modal-save-btn",function(b){b.preventDefault();var c=a(this).closest("form"),d=a(this).closest(".uixpbform-modal-box.active");1==d.find(".uixpbform-modal-save-btn").length&&(d.UixPBFormPopSaveAndRenderHtml({tempID:d.attr("data-tempID"),colID:d.attr("data-colID"),colIDToVar:d.attr("data-colIDToVar"),sectionID:d.attr("data-sectionID"),echoFrontendID:d.attr("data-echoFrontendID"),colNumber:d.attr("data-colNumber")}),l(c),a("[name='uix-page-builder-layoutdata']").val().indexOf('"content":""')>=0&&setTimeout(function(){l(c)},15),a(document).UixPBRenderFrontendPageTrigger());return a(document).UixPBFormPopClose(),!1})})}}(jQuery),function(a){a.fn.UixPBFormPopClose=function(b){a.extend({},b);this.each(function(){a(".uixpbform-modal-mask").fadeOut("fast"),a(".uixpbform-modal-box").removeClass("active").css("height","200px"),a("html").css("overflow-y","auto")})}}(jQuery),function(a){a.fn.UixPBFormPopSwitchTransition=function(b){a.extend({},b);this.each(function(){a(".uixpbform-modal-box").removeClass("active"),a("html").css("overflow-y","auto")})}}(jQuery),function(a){a.fn.UixPBFormPopWinReset=function(b){var c=a.extend({heightChange:!0},b);this.each(function(){var b=a(this);a(".uixpbform-modal-mask").fadeIn("fast"),b.addClass("active"),b.find(".uixpbform-modal-buttons").css("margin-top","50px"),c.heightChange&&b.css("height",parseFloat(.8*a(window).height()-150+150)+"px"),/^[-+]?(\d+|\d+\.\d*|\d*\.\d+)$/.test(c.heightChange)&&b.css("height",c.heightChange+"px"),b.find(".content").animate({scrollTop:10},100),a("html").css("overflow-y","hidden")})}}(jQuery),function(a){a.fn.UixPBFormPopSaveAndRenderHtml=function(b){var c=a.extend({tempID:"",colID:"",colIDToVar:"",sectionID:"",echoFrontendID:"",colNumber:""},b);this.each(function(){var d=(a(this),c.tempID),e=c.colID,f=c.colIDToVar,g=c.sectionID,h=c.echoFrontendID,i=c.colNumber,j=uixpbform_module_form_ids(d,g,e,!0),k=[],l=a("#uixpbform-form-all-field-ids-"+d).attr("data-field-ids"),m=[],n=uixpbform_module_form_keys(a("#module_tmpl__"+d).html()),o=[],p=[],q=[],r=[],s=a(a("#module_tmpl__"+d).html()).find("[data-clone-max]").attr("data-clone-max");if(void 0!==l)for(var t=l.split(","),u=0;u<t.length;u++){var v=uixpbform_to_controlName_ToVar(t[u],d,g,e);if(""!=v){var w=uixpbform_to_controlVarID_ToName(v),x=uixpbform_filter_control_id(w);v=v.replace(w,x),m.push(v)}}if(a("[name^='"+d+"-"+f+"']").each(function(){var b=a(this).attr("id").replace(d+"-"+f+"-","").replace("-"+g+"-","");b.indexOf("__index__")<0&&b.indexOf("_temp")>=0&&m.push(a(this).attr("id"))}),void 0!==s&&s>0){for(var y=[],z=1;z<s;z++)for(var u=0;u<m.length;u++)m[u].indexOf("_listitem")>=0&&a("#"+m[u]+z).length>0&&y.push(m[u]+z);m=m.concat(y)}for(var u=0;u<m.length;u++){var A=a("#"+m[u]),B=uixpbform_format_textarea(A);""!=B&&A.val(B);var C=m[u].replace(d+"-"+f+"-","").replace("-"+g+"-",""),D=uixpbform_to_controlSaveData_ToHTML(uixpbform_filter_control_val(A.val()));if(C.indexOf("__index__")<0){if(C.indexOf("_triggerclonelist")>=0&&C.indexOf("_temp")<0?C+="__fieldID":C.indexOf("_listitem")>=0&&C.indexOf("_temp")<0&&(C+="__fieldVal"),C.indexOf("_temp")<0){var E=A.data("callback");D=void 0!==E?uixpbform_value_callback(D,E):uixpbform_format_text_entering(D)}k.push({[C]:D})}}if(void 0!==s&&s>0&&"[object Array]"===Object.prototype.toString.call(k)){for(var u=0;u<k.length;u++){var F=k[u],G=JSON.stringify(F);if(G.indexOf("_listitem")>=0&&G.indexOf("_temp")<0){var H=G.replace(/^\{?|\}?$/g,"").split(":"),I=H[0].replace(/"/g,""),J=uixpbform_filter_control_id(uixpbform_to_cloneControlKey_ToSave(I));G=G.replace(I,J),q.push(uixpbform_to_cloneControlKey_ToSave(G)),uixpbform_to_cloneControlKey_notLoopIndex(I)&&p.push(uixpbform_to_cloneControlKey_ToSave(G))}}for(var u=0;u<q.length;u++)r.push(JSON.parse(q[u]));if("[object Array]"===Object.prototype.toString.call(n))for(var u=0;u<n.length;u++)n[u].indexOf("_triggerclonelist")>=0&&o.push(n[u]);for(var K=0,L=0,M=[],N="",O=0,P=0,Q=0,R=0,S=0,T=0,U=0,V=0,W="",X="",Y="",Z="",$=[],_=[],aa=[],ba=[],z=0;z<p.length;z++){var ca=p[z];ca.indexOf("_one_")>=0&&O++,ca.indexOf("_two_")>=0&&P++,ca.indexOf("_three_")>=0&&Q++,ca.indexOf("_four_")>=0&&R++,ca.indexOf("_one_")<0&&ca.indexOf("_two_")<0&&ca.indexOf("_three_")<0&&ca.indexOf("_four_")<0&&K++}for(var z=0;z<r.length;z++){var da=r[z],ca=JSON.stringify(da);ca.indexOf("_one_")>=0&&(S++,$.push(da)),ca.indexOf("_two_")>=0&&(T++,_.push(da)),ca.indexOf("_three_")>=0&&(U++,aa.push(da)),ca.indexOf("_four_")>=0&&(V++,ba.push(da)),ca.indexOf("_one_")<0&&ca.indexOf("_two_")<0&&ca.indexOf("_three_")<0&&ca.indexOf("_four_")<0&&(L++,M.push(da))}if(N=uixpbform_cloned_groupStr_frontend(M,L,K),W=uixpbform_cloned_groupStr_frontend($,S,O),X=uixpbform_cloned_groupStr_frontend(_,T,P),Y=uixpbform_cloned_groupStr_frontend(aa,U,Q),Z=uixpbform_cloned_groupStr_frontend(ba,V,R),o.length>0)for(var ea=0;ea<o.length;ea++){var fa=o[ea];fa.indexOf("_one_")>=0&&W.length>0&&k.push({[fa]:W}),fa.indexOf("_two_")>=0&&X.length>0&&k.push({[fa]:X}),fa.indexOf("_three_")>=0&&Y.length>0&&k.push({[fa]:Y}),fa.indexOf("_four_")>=0&&Z.length>0&&k.push({[fa]:Z}),fa.indexOf("_one_")<0&&fa.indexOf("_two_")<0&&fa.indexOf("_three_")<0&&fa.indexOf("_four_")<0&&N.length>0&&k.push({[fa]:N})}}k=uixpbform_arr_to_tempjson(k,!1,!0),k=uixpbform_module_form_JsonResult_frontend(k),a(h).html(""),a("#frontend_module_tmpl__"+d).tmpl(JSON.parse(k)).appendTo(h);var ga=a(h).html();a("#"+j).val(ga),a(document).UixPBRenderHTML({divID:"#section_"+g+"__"+i,value:uixpbform_format_text_decode(ga,!0)})})}}(jQuery);